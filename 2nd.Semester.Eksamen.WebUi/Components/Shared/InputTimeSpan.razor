@inherits InputBase<TimeSpan>
@using System.Globalization

<input type="time"
       class="@CssClass"
       value="@CurrentValue.ToString(@"hh\:mm")"
       @onchange="OnChange" />

@code {
    private void OnChange(ChangeEventArgs e)
    {
        if (BindConverter.TryConvertTo<TimeSpan>(
            e.Value?.ToString(),
            CultureInfo.InvariantCulture,
            out var result))
        {
            CurrentValue = result;
        }
        else
        {
            EditContext?.NotifyFieldChanged(FieldIdentifier);
        }
    }

    protected override bool TryParseValueFromString(
        string? value,
        out TimeSpan result,
        out string validationErrorMessage)
    {
        if (TimeSpan.TryParse(value, out result))
        {
            validationErrorMessage = null!;
            return true;
        }

        validationErrorMessage = "Invalid time format";
        return false;
    }
}