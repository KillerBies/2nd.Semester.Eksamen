@page "/Create-Treatment"
@namespace _2nd.Semester.Eksamen.WebUi.Components.Pages.ProductPages.TreatmentPages
@using _2nd.Semester.Eksamen.WebUi.Components.Shared
@using _2nd.Semester.Eksamen.WebUi.Components.Pages.ProductPages.BookingPages
@rendermode InteractiveServer

    <FloatingPage>
        <div style="margin: 30px;">
            <EditForm Model="@treatment"
                      OnValidSubmit="@HandleValidSubmit"
                      FormName="CreateTreatment">

                <DataAnnotationsValidator />
                <ValidationSummary />

                <h2 class="text-center mb-4">Lav Ny Behandling</h2>

                <div class="mb-3">
                    <label class="form-label">Navn:</label>
                    <InputText @bind-Value="treatment.Name"
                               class="form-control"
                               placeholder="Navn..." />
                </div>

                <div class="mb-3">
                    <label class="form-label">Kategori:</label>
                    <InputText @bind-Value="treatment.Category"
                               class="form-control"
                               placeholder="Kategori..." />
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <label class="form-label">Pris:</label>
                        <InputNumber @bind-Value="treatment.BasePrice"
                                     class="form-control"
                                     placeholder="Pris..." />
                    </div>
                    <div class="col-md-6">
                        <label class="form-label">Varighed:</label>
                        <input type="time" @bind-value="Varighed"
                               class="form-control"
                               placeholder="Timer..." />
                    </div>
                </div>

                <div class="mb-3">
                    <label class="form-label">Vælg eksisterende specialiteter:</label>
                    <div class="border rounded p-2" style="overflow-y:scroll; height:7.7rem">
                        @foreach (var specialty in specialtyItems.Where(s => !string.IsNullOrWhiteSpace(s.Specialty)))
                        {
                            <div class="form-check">
                                <InputCheckbox class="form-check-input"
                                               @bind-Value="specialty.Status" />
                                <label class="form-check-label ms-2">
                                    @specialty.Specialty
                                </label>
                            </div>
                        }
                    </div>
                </div>

                <div class="mb-3">
                    <label class="form-label">Tilføj ny specialitet:</label>
                    <div class="d-flex gap-2">
                        <InputText @bind-Value="newSpecialty"
                                   class="form-control"
                                   placeholder="Ny specialitet..." />
                        <button type="button"
                                class="btn btn-outline-primary h-100"
                                @onclick="AddSpecialty">
                            Tilføj
                        </button>
                    </div>
                </div>

                @if (manuallyAddedSpecialties.Any())
                {
                    <ul class="list-group mb-3">
                        @foreach (var item in manuallyAddedSpecialties.Where(s=>!string.IsNullOrWhiteSpace(s)))
                        {
                            <li class="list-group-item d-flex justify-content-between align-items-center" style="padding-left:10px;">
                                @item
                                <button 
                                        class="btn btn-sm bg-transparent" style="height:100%; padding:0;margin:0;margin-right:4px; color:darkred;"
                                        @onclick="() => RemoveSpecialty(item)">
                                    X
                                </button>
                            </li>
                        }
                    </ul>
                }

                <div class="mb-3">
                    <label class="form-label">Beskrivelse:</label>
                    <InputTextArea @bind-Value="treatment.Description"
                                   class="form-control"
                                   placeholder="Beskrivelse..."
                                   maxlength="200" />
                </div>

                <div class="text-center mt-4">
                    <button type="submit"
                            class="btn btn-primary w-75">
                        Opret Behandling
                    </button>
                </div>

            </EditForm>
        </div>
    </FloatingPage>









